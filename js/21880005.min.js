const API="https://web1-api.vercel.app/api",AUTHENTICATE_API="https://web1-api.vercel.app/users";async function loadData(request,templateId,viewID){const response=await fetch(API.concat("/",request)),data=await response.json();var template=Handlebars.templates[`${templateId}.hbs`],context={data:data},view;document.getElementById(viewID).innerHTML=template(context)}async function getAuthenticateToken(username,password){let response=await fetch(`${AUTHENTICATE_API}/authenticate`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:username,password:password})}),result=await response.json();if(200==response.status)return result.token;throw new Error(result.message)}async function login(e){e.preventDefault();let username=document.getElementById("username").value,password=document.getElementById("password").value;document.getElementById("errorMessage").innerHTML="";try{let token=await getAuthenticateToken(username,password);token&&(localStorage.setItem("token",token),document.getElementsByClassName("btn-close")[0].click(),displayControls())}catch(error){document.getElementById("errorMessage").innerHTML=error,displayControls(!1)}}function displayControls(isLogin=!0){let linkLogins=document.getElementsByClassName("linkLogin"),linkLogouts=document.getElementsByClassName("linkLogout"),displayLogin="none",displaylogout="block";isLogin||(displayLogin="block",displaylogout="none");for(let i=0;i<2;i++)linkLogins[i].style.display=displayLogin,linkLogouts[i].style.display=displaylogout;let leaveComment=document.getElementById("leave-comment");leaveComment&&(leaveComment.style.display=displaylogout)}async function checkLogin(){let isLogin;displayControls(await verifyToken())}async function verifyToken(){let token=localStorage.getItem("token");if(token){let response;if(200==(await fetch(`${AUTHENTICATE_API}/verify`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+token}})).status)return!0}return!1}function logout(){localStorage.clear(),displayControls(!1)}